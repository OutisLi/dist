<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2024.03.01-3.1 Generators: Parameters</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.9f84806b.css" as="style"><link rel="preload" href="/assets/js/app.aca65f08.js" as="script"><link rel="preload" href="/assets/js/2.0c4bddf9.js" as="script"><link rel="preload" href="/assets/js/1.50b457b8.js" as="script"><link rel="preload" href="/assets/js/38.fb00ff7f.js" as="script"><link rel="prefetch" href="/assets/js/10.325b9f09.js"><link rel="prefetch" href="/assets/js/11.845e3692.js"><link rel="prefetch" href="/assets/js/12.ecdb524b.js"><link rel="prefetch" href="/assets/js/13.3f3f6a36.js"><link rel="prefetch" href="/assets/js/14.eb7a3d07.js"><link rel="prefetch" href="/assets/js/15.b60f3925.js"><link rel="prefetch" href="/assets/js/16.85253907.js"><link rel="prefetch" href="/assets/js/17.c2838453.js"><link rel="prefetch" href="/assets/js/18.3256f17f.js"><link rel="prefetch" href="/assets/js/19.d8afd0ae.js"><link rel="prefetch" href="/assets/js/20.10e47ab9.js"><link rel="prefetch" href="/assets/js/21.33b300c9.js"><link rel="prefetch" href="/assets/js/22.62284270.js"><link rel="prefetch" href="/assets/js/23.7db5debe.js"><link rel="prefetch" href="/assets/js/24.c7d90f40.js"><link rel="prefetch" href="/assets/js/25.6eea5c7e.js"><link rel="prefetch" href="/assets/js/26.9050baa1.js"><link rel="prefetch" href="/assets/js/27.580760bf.js"><link rel="prefetch" href="/assets/js/28.de97261b.js"><link rel="prefetch" href="/assets/js/29.6c399461.js"><link rel="prefetch" href="/assets/js/3.af33e5d6.js"><link rel="prefetch" href="/assets/js/30.0d308e4d.js"><link rel="prefetch" href="/assets/js/31.e3d87865.js"><link rel="prefetch" href="/assets/js/32.06d47597.js"><link rel="prefetch" href="/assets/js/33.b2f53157.js"><link rel="prefetch" href="/assets/js/34.b56caa5e.js"><link rel="prefetch" href="/assets/js/35.3ddbf166.js"><link rel="prefetch" href="/assets/js/36.39948275.js"><link rel="prefetch" href="/assets/js/37.0d9f8801.js"><link rel="prefetch" href="/assets/js/39.336735c7.js"><link rel="prefetch" href="/assets/js/4.45665f8a.js"><link rel="prefetch" href="/assets/js/40.89589368.js"><link rel="prefetch" href="/assets/js/41.f8b893e2.js"><link rel="prefetch" href="/assets/js/42.02e366b2.js"><link rel="prefetch" href="/assets/js/43.04786f37.js"><link rel="prefetch" href="/assets/js/44.33f8b3ae.js"><link rel="prefetch" href="/assets/js/45.acb58579.js"><link rel="prefetch" href="/assets/js/46.26b94de1.js"><link rel="prefetch" href="/assets/js/47.0e4b18e7.js"><link rel="prefetch" href="/assets/js/48.21e56b0a.js"><link rel="prefetch" href="/assets/js/49.28eb16aa.js"><link rel="prefetch" href="/assets/js/5.7098d77a.js"><link rel="prefetch" href="/assets/js/50.7bec212f.js"><link rel="prefetch" href="/assets/js/51.b5f5758a.js"><link rel="prefetch" href="/assets/js/52.72a43db2.js"><link rel="prefetch" href="/assets/js/6.0c0a0f39.js"><link rel="prefetch" href="/assets/js/7.6a854e57.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.77260563.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9f84806b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/good.png" alt="" class="logo"> <!----></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="LeetCode" class="dropdown-title"><span class="title">LeetCode</span> <span class="arrow down"></span></button> <button type="button" aria-label="LeetCode" class="mobile-dropdown-title"><span class="title">LeetCode</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          二叉树
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">
  Installation
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  xxx
</a></li></ul></li><li class="dropdown-item"><h4>
          滑动窗口
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">
  Installation
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  xxx
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Chip" class="dropdown-title"><span class="title">Chip</span> <span class="arrow down"></span></button> <button type="button" aria-label="Chip" class="mobile-dropdown-title"><span class="title">Chip</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          一生一芯
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Chip/Chip/一生一芯计划.html" class="nav-link">
  预学习
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  B阶段
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  A阶段
</a></li></ul></li><li class="dropdown-item"><h4>
          Chisel
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Chip/Chip/2024.02.21-Chisel.html" class="nav-link">
  Bootcamp
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  xxx
</a></li></ul></li><li class="dropdown-item"><h4>
          Verilog
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Chip/Chip/2023.11.07-Verilog语法.html" class="nav-link">
  Basic
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  xxx
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="LeetCode" class="dropdown-title"><span class="title">LeetCode</span> <span class="arrow down"></span></button> <button type="button" aria-label="LeetCode" class="mobile-dropdown-title"><span class="title">LeetCode</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          二叉树
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">
  Installation
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  xxx
</a></li></ul></li><li class="dropdown-item"><h4>
          滑动窗口
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">
  Installation
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  xxx
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Chip" class="dropdown-title"><span class="title">Chip</span> <span class="arrow down"></span></button> <button type="button" aria-label="Chip" class="mobile-dropdown-title"><span class="title">Chip</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          一生一芯
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Chip/Chip/一生一芯计划.html" class="nav-link">
  预学习
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  B阶段
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  A阶段
</a></li></ul></li><li class="dropdown-item"><h4>
          Chisel
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Chip/Chip/2024.02.21-Chisel.html" class="nav-link">
  Bootcamp
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  xxx
</a></li></ul></li><li class="dropdown-item"><h4>
          Verilog
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Chip/Chip/2023.11.07-Verilog语法.html" class="nav-link">
  Basic
</a></li><li class="dropdown-subitem"><a href="/language/japanese/" class="nav-link">
  xxx
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>2024 02 21 Chisel</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.02.21-1 Introduction to Scala.html" class="sidebar-link">2024.02.21-1. Introduction to Scala</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.02.23-2.1 First Chisel Module.html" class="sidebar-link">2024.02.23-2.1 First Chisel Module</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.02.24-2.2 Combinational Logic.html" class="sidebar-link">2024.02.24-2.2 Combinational Logic</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.02.25-2.3 Control Flow.html" class="sidebar-link">2024.02.25-2.3 Control Flow</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.02.26-2.4 Sequential Logic.html" class="sidebar-link">2024.02.26-2.4 Sequential Logic</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.02.28-2.5 FIR Filter.html" class="sidebar-link">2024.02.28-2.5 FIR Filter</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.02.29-2.6 More on ChiselTest.html" class="sidebar-link">2024.02.29-2.6 More on ChiselTest</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.01-3.1 Generators Parameters.html" class="active sidebar-link">2024.03.01-3.1 Generators: Parameters</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.01-3.1 Generators Parameters.html#parameter-passing" class="sidebar-link">Parameter Passing</a></li><li class="sidebar-sub-header"><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.01-3.1 Generators Parameters.html#option-and-defualt-arguments" class="sidebar-link">Option and Defualt Arguments</a></li><li class="sidebar-sub-header"><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.01-3.1 Generators Parameters.html#match-case-statements" class="sidebar-link">Match/Case Statements</a></li><li class="sidebar-sub-header"><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.01-3.1 Generators Parameters.html#ios-with-optional-fields" class="sidebar-link">IOs with Optional Fields</a></li><li class="sidebar-sub-header"><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.01-3.1 Generators Parameters.html#implicits" class="sidebar-link">Implicits</a></li></ul></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.03-3.2 Generators Collections.html" class="sidebar-link">2024.03.03-3.2 Generators: Collections</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.04-3.3 Interlude Chisel Standard Library.html" class="sidebar-link">2024.03.04-3.3 Interlude: Chisel Standard Library</a></li><li><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.05-3.4 Higher-Order Functions.html" class="sidebar-link">2024.03.05-3.4 Higher-Order Functions</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2024-03-01-3-1-generators-parameters"><a href="#_2024-03-01-3-1-generators-parameters" class="header-anchor">#</a> 2024.03.01-3.1 Generators: Parameters</h1> <h2 id="parameter-passing"><a href="#parameter-passing" class="header-anchor">#</a> Parameter Passing</h2> <h3 id="example-parameterized-scala-object"><a href="#example-parameterized-scala-object" class="header-anchor">#</a> Example: Parameterized Scala Object</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> ParameterizedScalaObject<span class="token punctuation">(</span>param1<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> param2<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;I have parameters: param1 = </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">param1</span></span><span class="token string"> and param2 = </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">param2</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">val</span> obj1 <span class="token operator">=</span> <span class="token keyword">new</span> ParameterizedScalaObject<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>     <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> obj2 <span class="token operator">=</span> <span class="token keyword">new</span> ParameterizedScalaObject<span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="example-parameterized-chisel-object"><a href="#example-parameterized-chisel-object" class="header-anchor">#</a> Example: Parameterized Chisel Object</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> ParameterizedWidthAdder<span class="token punctuation">(</span>in0Width<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> in1Width<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> sumWidth<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Module <span class="token punctuation">{</span>
  require<span class="token punctuation">(</span>in0Width <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
  require<span class="token punctuation">(</span>in1Width <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
  require<span class="token punctuation">(</span>sumWidth <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> io <span class="token operator">=</span> IO<span class="token punctuation">(</span><span class="token keyword">new</span> Bundle <span class="token punctuation">{</span>
    <span class="token keyword">val</span> in0 <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span>in0Width<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> in1 <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span>in1Width<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> sum <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span>sumWidth<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// a +&amp; b includes the carry, a + b does not</span>
  io<span class="token punctuation">.</span>sum <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in0 <span class="token operator">+</span><span class="token operator">&amp;</span> io<span class="token punctuation">.</span>in1
<span class="token punctuation">}</span>

println<span class="token punctuation">(</span>getVerilog<span class="token punctuation">(</span><span class="token keyword">new</span> ParameterizedWidthAdder<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>The above code block has some <code>require(...)</code> statements. These are pre-elaboration assertions, which are useful when your generator only works with certain parameterizations or when some parameterizations are mutually exclusive or nonsensical. The above code block checks that widths are non-negative.</p> <h3 id="example-parameterized-4-input-sort"><a href="#example-parameterized-4-input-sort" class="header-anchor">#</a> Example: Parameterized 4-input Sort</h3> <p><img src="2024%2003%2001-3%201%20Generators%20Parameters%201016bf0c74d441b0ac088c81d6368a0b/Untitled.png" alt="Untitled"></p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token comment">/** Sort4 sorts its 4 inputs to its 4 outputs */</span>
<span class="token keyword">class</span> Sort4<span class="token punctuation">(</span>ascending<span class="token operator">:</span> <span class="token builtin">Boolean</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Module <span class="token punctuation">{</span>
  <span class="token keyword">val</span> io <span class="token operator">=</span> IO<span class="token punctuation">(</span><span class="token keyword">new</span> Bundle <span class="token punctuation">{</span>
    <span class="token keyword">val</span> in0 <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> in1 <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> in2 <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> in3 <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> out0 <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> out1 <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> out2 <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> out3 <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
  <span class="token comment">// this comparison funtion decides &lt; or &gt; based on the module's parameterization</span>
  <span class="token keyword">def</span> comp<span class="token punctuation">(</span>l<span class="token operator">:</span> UInt<span class="token punctuation">,</span> r<span class="token operator">:</span> UInt<span class="token punctuation">)</span><span class="token operator">:</span> Bool <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>ascending<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        l <span class="token operator">&lt;</span> r
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        l <span class="token operator">&gt;</span> r
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">val</span> row10 <span class="token operator">=</span> Wire<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> row11 <span class="token operator">=</span> Wire<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> row12 <span class="token operator">=</span> Wire<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> row13 <span class="token operator">=</span> Wire<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>

  when<span class="token punctuation">(</span>comp<span class="token punctuation">(</span>io<span class="token punctuation">.</span>in0<span class="token punctuation">,</span> io<span class="token punctuation">.</span>in1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    row10 <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in0            <span class="token comment">// preserve first two elements</span>
    row11 <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in1
  <span class="token punctuation">}</span><span class="token punctuation">.</span>otherwise <span class="token punctuation">{</span>
    row10 <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in1            <span class="token comment">// swap first two elements</span>
    row11 <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in0
  <span class="token punctuation">}</span>

  when<span class="token punctuation">(</span>comp<span class="token punctuation">(</span>io<span class="token punctuation">.</span>in2<span class="token punctuation">,</span> io<span class="token punctuation">.</span>in3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    row12 <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in2            <span class="token comment">// preserve last two elements</span>
    row13 <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in3
  <span class="token punctuation">}</span><span class="token punctuation">.</span>otherwise <span class="token punctuation">{</span>
    row12 <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in3            <span class="token comment">// swap last two elements</span>
    row13 <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in2
  <span class="token punctuation">}</span>

  <span class="token keyword">val</span> row21 <span class="token operator">=</span> Wire<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> row22 <span class="token operator">=</span> Wire<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>

  when<span class="token punctuation">(</span>comp<span class="token punctuation">(</span>row11<span class="token punctuation">,</span> row12<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    row21 <span class="token operator">:</span><span class="token operator">=</span> row11            <span class="token comment">// preserve middle 2 elements</span>
    row22 <span class="token operator">:</span><span class="token operator">=</span> row12
  <span class="token punctuation">}</span><span class="token punctuation">.</span>otherwise <span class="token punctuation">{</span>
    row21 <span class="token operator">:</span><span class="token operator">=</span> row12            <span class="token comment">// swap middle two elements</span>
    row22 <span class="token operator">:</span><span class="token operator">=</span> row11
  <span class="token punctuation">}</span>

  <span class="token keyword">val</span> row20 <span class="token operator">=</span> Wire<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> row23 <span class="token operator">=</span> Wire<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  when<span class="token punctuation">(</span>comp<span class="token punctuation">(</span>row10<span class="token punctuation">,</span> row13<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    row20 <span class="token operator">:</span><span class="token operator">=</span> row10            <span class="token comment">// preserve the first and the forth elements</span>
    row23 <span class="token operator">:</span><span class="token operator">=</span> row13
  <span class="token punctuation">}</span><span class="token punctuation">.</span>otherwise <span class="token punctuation">{</span>
    row20 <span class="token operator">:</span><span class="token operator">=</span> row13            <span class="token comment">// swap the first and the forth elements</span>
    row23 <span class="token operator">:</span><span class="token operator">=</span> row10
  <span class="token punctuation">}</span>

  when<span class="token punctuation">(</span>comp<span class="token punctuation">(</span>row20<span class="token punctuation">,</span> row21<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    io<span class="token punctuation">.</span>out0 <span class="token operator">:</span><span class="token operator">=</span> row20            <span class="token comment">// preserve first two elements</span>
    io<span class="token punctuation">.</span>out1 <span class="token operator">:</span><span class="token operator">=</span> row21
  <span class="token punctuation">}</span><span class="token punctuation">.</span>otherwise <span class="token punctuation">{</span>
    io<span class="token punctuation">.</span>out0 <span class="token operator">:</span><span class="token operator">=</span> row21            <span class="token comment">// swap first two elements</span>
    io<span class="token punctuation">.</span>out1 <span class="token operator">:</span><span class="token operator">=</span> row20
  <span class="token punctuation">}</span>

  when<span class="token punctuation">(</span>comp<span class="token punctuation">(</span>row22<span class="token punctuation">,</span> row23<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    io<span class="token punctuation">.</span>out2 <span class="token operator">:</span><span class="token operator">=</span> row22            <span class="token comment">// preserve first two elements</span>
    io<span class="token punctuation">.</span>out3 <span class="token operator">:</span><span class="token operator">=</span> row23
  <span class="token punctuation">}</span><span class="token punctuation">.</span>otherwise <span class="token punctuation">{</span>
    io<span class="token punctuation">.</span>out2 <span class="token operator">:</span><span class="token operator">=</span> row23            <span class="token comment">// swap first two elements</span>
    io<span class="token punctuation">.</span>out3 <span class="token operator">:</span><span class="token operator">=</span> row22
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="option-and-defualt-arguments"><a href="#option-and-defualt-arguments" class="header-anchor">#</a> Option and Defualt Arguments</h2> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> map <span class="token operator">=</span> Map<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span> <span class="token operator">-&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> a <span class="token operator">=</span> map<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span>
println<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">val</span> b <span class="token operator">=</span> map<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span>
println<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
</code></pre></div><p>在Scala中，<strong><code>Map.get(key)</code><strong>方法返回一个</strong><code>Option</code><strong>类型：如果键存在，则返回</strong><code>Some(value)</code></strong>；如果键不存在，则返回**<code>None</code><strong>。在您的例子中，</strong><code>map.get(&quot;a&quot;)</code><strong>返回</strong><code>Some(1)</code><strong>，因为&quot;a&quot;是映射中的一个键，值为1。然而，</strong><code>map.get(&quot;b&quot;)</code><strong>返回</strong><code>None</code><strong>，因为&quot;b&quot;不是映射中的键。</strong><code>Some</code><strong>和</strong><code>None</code>**用于Scala中以安全且表达性的方式处理值的存在或缺失，避免空指针异常。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> some <span class="token operator">=</span> Some<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> none <span class="token operator">=</span> None
println<span class="token punctuation">(</span>some<span class="token punctuation">.</span>get<span class="token punctuation">)</span>          <span class="token comment">// Returns 1</span>
<span class="token comment">// println(none.get)       // Errors!</span>
println<span class="token punctuation">(</span>some<span class="token punctuation">.</span>getOrElse<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Returns 1</span>
println<span class="token punctuation">(</span>none<span class="token punctuation">.</span>getOrElse<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Returns 2</span>
</code></pre></div><p><strong><code>getOrElse</code><strong>是一个常用于</strong><code>Option</code><strong>类型的方法，它允许你为</strong><code>Option</code><strong>可能不包含值（即为</strong><code>None</code></strong>）的情况提供一个默认值。<strong><code>getOrElse</code><strong>接受一个参数，这个参数是当</strong><code>Option</code><strong>为</strong><code>None</code><strong>时将返回的值。如果</strong><code>Option</code><strong>是</strong><code>Some</code></strong>，则**<code>getOrElse</code><strong>会返回包裹在</strong><code>Some</code>**中的值。</p> <h3 id="options-for-parameters-with-defaults"><a href="#options-for-parameters-with-defaults" class="header-anchor">#</a> Options for Parameters with Defaults</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> DelayBy1<span class="token punctuation">(</span>resetValue<span class="token operator">:</span> Option<span class="token punctuation">[</span>UInt<span class="token punctuation">]</span> <span class="token operator">=</span> None<span class="token punctuation">)</span> <span class="token keyword">extends</span> Module <span class="token punctuation">{</span>
    <span class="token keyword">val</span> io <span class="token operator">=</span> IO<span class="token punctuation">(</span><span class="token keyword">new</span> Bundle <span class="token punctuation">{</span>
        <span class="token keyword">val</span> in  <span class="token operator">=</span> Input<span class="token punctuation">(</span> UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> out <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> reg <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>resetValue<span class="token punctuation">.</span>isDefined<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// resetValue = Some(number)</span>
        RegInit<span class="token punctuation">(</span>resetValue<span class="token punctuation">.</span>get<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">//resetValue = None</span>
        Reg<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    reg <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in
    io<span class="token punctuation">.</span>out <span class="token operator">:</span><span class="token operator">=</span> reg
<span class="token punctuation">}</span>

println<span class="token punctuation">(</span>getVerilog<span class="token punctuation">(</span><span class="token keyword">new</span> DelayBy1<span class="token punctuation">)</span><span class="token punctuation">)</span>
println<span class="token punctuation">(</span>getVerilog<span class="token punctuation">(</span><span class="token keyword">new</span> DelayBy1<span class="token punctuation">(</span>Some<span class="token punctuation">(</span><span class="token number">3.</span>U<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>将 <code>resetValue</code> 默认初始化为 <code>Option[UInt] = None</code>，<code>Reg(UInt())</code> 可以从上下文中自动推断，不过最好还是指定位宽</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token comment">// 还可以用match来实现ifelse</span>
<span class="token keyword">class</span> DelayBy1<span class="token punctuation">(</span>resetValue<span class="token operator">:</span> Option<span class="token punctuation">[</span>UInt<span class="token punctuation">]</span> <span class="token operator">=</span> None<span class="token punctuation">)</span> <span class="token keyword">extends</span> Module <span class="token punctuation">{</span>
  <span class="token keyword">val</span> io <span class="token operator">=</span> IO<span class="token punctuation">(</span><span class="token keyword">new</span> Bundle <span class="token punctuation">{</span>
    <span class="token keyword">val</span> in  <span class="token operator">=</span> Input<span class="token punctuation">(</span> UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> out <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">16.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> reg <span class="token operator">=</span> resetValue <span class="token keyword">match</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> Some<span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> RegInit<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
    <span class="token keyword">case</span> None    <span class="token keyword">=&gt;</span> Reg<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  reg <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in
  io<span class="token punctuation">.</span>out <span class="token operator">:</span><span class="token operator">=</span> reg
<span class="token punctuation">}</span>
</code></pre></div><h2 id="match-case-statements"><a href="#match-case-statements" class="header-anchor">#</a> Match/Case Statements</h2> <p>Scala中的匹配概念在Chisel中被广泛使用，是每个Chisel程序员必须理解的基础知识。Scala提供的match操作符支持以下功能：</p> <ul><li>用于检测多种情况的简单测试，类似于C语言中的switch语句。</li> <li>对值的复杂组合进行测试。</li> <li>根据变量的类型采取行动，当变量类型未知或未完全指定时，例如：
<ul><li>从异构列表中取变量，如**<code>val mixedList = List(1, &quot;string&quot;, false)</code>**。</li> <li>变量已知属于一个超类，但不确定是哪个具体的子类。</li></ul></li> <li>使用正则表达式提取字符串的子串。</li></ul> <h3 id="example-value-matching"><a href="#example-value-matching" class="header-anchor">#</a> Example: Value Matching</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token comment">// y is an integer variable defined somewhere else in the code</span>
<span class="token keyword">val</span> y <span class="token operator">=</span> <span class="token number">7</span>
<span class="token comment">/// ...</span>
<span class="token keyword">val</span> x <span class="token operator">=</span> y <span class="token keyword">match</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token number">0</span> <span class="token keyword">=&gt;</span> <span class="token string">&quot;zero&quot;</span> <span class="token comment">// One common syntax, preferred if fits in one line</span>
  <span class="token keyword">case</span> <span class="token number">1</span> <span class="token keyword">=&gt;</span>        <span class="token comment">// Another common syntax, preferred if does not fit in one line.</span>
      <span class="token string">&quot;one&quot;</span>        <span class="token comment">// Note the code block continues until the next case</span>
  <span class="token keyword">case</span> <span class="token number">2</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span>      <span class="token comment">// Another syntax, but curly braces are not required</span>
      <span class="token string">&quot;two&quot;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">case</span> _ <span class="token keyword">=&gt;</span> <span class="token string">&quot;many&quot;</span> <span class="token comment">// _ is a wildcard that matches all values</span>
<span class="token punctuation">}</span>
println<span class="token punctuation">(</span><span class="token string">&quot;y is &quot;</span> <span class="token operator">+</span> x<span class="token punctuation">)</span> <span class="token comment">// out: y is many</span>
</code></pre></div><p>y 为7，不匹配，因此采用默认值</p> <ul><li>每个跟在**<code>=&gt;</code><strong>操作符后面的代码块都会继续执行，直到它到达</strong><code>match</code><strong>的结束大括号或下一个</strong><code>case</code>**语句。</li> <li>**<code>match</code><strong>会按照</strong><code>case</code><strong>语句的顺序进行搜索，一旦匹配到一个</strong><code>case</code><strong>语句，就不会再对其他</strong><code>case</code>**语句进行检查。</li> <li>使用下划线**<code>_</code>**作为通配符，来处理任何未找到匹配的值。</li></ul> <h3 id="example-multiple-value-matching"><a href="#example-multiple-value-matching" class="header-anchor">#</a> Example: Multiple Value Matching</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">def</span> animalType<span class="token punctuation">(</span>biggerThanBreadBox<span class="token operator">:</span> <span class="token builtin">Boolean</span><span class="token punctuation">,</span> meanAsCanBe<span class="token operator">:</span> <span class="token builtin">Boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>biggerThanBreadBox<span class="token punctuation">,</span> meanAsCanBe<span class="token punctuation">)</span> <span class="token keyword">match</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token string">&quot;wolverine&quot;</span>
    <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token string">&quot;elephant&quot;</span>
    <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token string">&quot;shrew&quot;</span>
    <span class="token keyword">case</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token string">&quot;puppy&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
println<span class="token punctuation">(</span>animalType<span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// wolverine</span>
</code></pre></div><h3 id="example-type-matching"><a href="#example-type-matching" class="header-anchor">#</a> Example: Type Matching</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> sequence <span class="token operator">=</span> Seq<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
sequence<span class="token punctuation">.</span>foreach <span class="token punctuation">{</span> x <span class="token keyword">=&gt;</span>
  x <span class="token keyword">match</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> s<span class="token operator">:</span> <span class="token builtin">String</span> <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is a String&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> s<span class="token operator">:</span> <span class="token builtin">Int</span>    <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is an Int&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> s<span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is a Double&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> _ <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is an unknown type!&quot;</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong><code>Seq</code><strong>是Scala集合中的一个接口，它代表序列，而</strong><code>List</code><strong>是</strong><code>Seq</code><strong>的一个具体实现。在这个例子中，可以直接用</strong><code>List(&quot;a&quot;, 1, 0.0)</code><strong>来代替</strong><code>Seq(&quot;a&quot;, 1, 0.0)</code></strong>，而不会影响**<code>foreach</code><strong>和</strong><code>match</code>**语句的行为。</p> <h3 id="example-multiple-type-matching"><a href="#example-multiple-type-matching" class="header-anchor">#</a> Example: Multiple Type Matching</h3> <p>If you want to match on whether a value has one of many types, use the following syntax. Note that you must use an <code>_</code> when matching.</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> sequence <span class="token operator">=</span> Seq<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span>
sequence<span class="token punctuation">.</span>foreach <span class="token punctuation">{</span> x <span class="token keyword">=&gt;</span>
  x <span class="token keyword">match</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> _<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">|</span> _<span class="token operator">:</span> <span class="token builtin">Double</span> <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is a number!&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> _ <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is an unknown type!&quot;</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="example-type-matching-and-erasure"><a href="#example-type-matching-and-erasure" class="header-anchor">#</a> Example: Type Matching and Erasure</h3> <p>类型匹配在Scala中有一些限制。由于Scala运行在JVM上，而JVM不保持多态类型信息，因此你不能在运行时基于它们进行匹配（因为这些类型信息已被擦除）。注意下面的例子始终匹配第一个case语句，因为**<code>[String]</code><strong>、</strong><code>[Int]</code><strong>、</strong><code>[Double]</code><strong>这些多态类型在运行时被擦除了，case语句</strong>实际上<strong>只是在匹配</strong><code>Seq</code>**。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> sequence <span class="token operator">=</span> Seq<span class="token punctuation">(</span>Seq<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Seq<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Seq<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sequence<span class="token punctuation">.</span>foreach <span class="token punctuation">{</span> x <span class="token keyword">=&gt;</span>
  x <span class="token keyword">match</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> s<span class="token operator">:</span> Seq<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is a String&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> s<span class="token operator">:</span> Seq<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span>    <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is an Int&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> s<span class="token operator">:</span> Seq<span class="token punctuation">[</span><span class="token builtin">Double</span><span class="token punctuation">]</span> <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">x</span></span><span class="token string"> is a Double&quot;</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在Scala中，类型擦除指的是JVM在运行时不保留泛型的具体类型信息。因此，当你对**<code>Seq[String]</code><strong>、</strong><code>Seq[Int]</code><strong>或</strong><code>Seq[Double]</code><strong>进行模式匹配时，JVM实际上无法区分这些</strong><code>Seq</code><strong>的元素类型，因为泛型信息</strong><code>[String]</code><strong>、</strong><code>[Int]</code><strong>、</strong><code>[Double]</code><strong>已经被擦除，只留下了基础的</strong><code>Seq</code><strong>类型。所以，这些case语句在运行时都被视为对</strong><code>Seq</code><strong>类型的匹配，而无法区分具体是哪种</strong><code>Seq</code><strong>。因此，匹配总是成功于第一个case，无论其实际参数是什么类型的</strong><code>Seq</code><strong>。这就是为什么在运行时你看到的行为似乎是它总是匹配</strong><code>Seq</code>**的原因。</p> <h2 id="ios-with-optional-fields"><a href="#ios-with-optional-fields" class="header-anchor">#</a> IOs with Optional Fields</h2> <p>有时我们希望IO端口能够根据需要选择性地包含或排除。例如，在调试时可能需要查看一些内部状态，但在生成器用于系统时希望将其隐藏。或者，你的生成器可能有一些输入在某些情况下不需要连接，因为存在合理的默认值。</p> <h3 id="example-optional-io-with-option"><a href="#example-optional-io-with-option" class="header-anchor">#</a> Example: Optional IO with Option</h3> <p>示例中展示了一个可选地接收进位信号的一位加法器。如果包含进位，**<code>io.carryIn</code><strong>将是</strong><code>Some[UInt]</code><strong>类型并包含在IO束中；如果不包含进位，</strong><code>io.carryIn</code><strong>将是</strong><code>None</code>**类型并从IO束中排除。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> HalfFullAdder<span class="token punctuation">(</span><span class="token keyword">val</span> hasCarry<span class="token operator">:</span> <span class="token builtin">Boolean</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Module <span class="token punctuation">{</span>
  <span class="token keyword">val</span> io <span class="token operator">=</span> IO<span class="token punctuation">(</span><span class="token keyword">new</span> Bundle <span class="token punctuation">{</span>
    <span class="token keyword">val</span> a <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> b <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> carryIn <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>hasCarry<span class="token punctuation">)</span> Some<span class="token punctuation">(</span>Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">else</span> None
    <span class="token keyword">val</span> s <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> carryOut <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> sum <span class="token operator">=</span> io<span class="token punctuation">.</span>a <span class="token operator">+</span><span class="token operator">&amp;</span> io<span class="token punctuation">.</span>b <span class="token operator">+</span><span class="token operator">&amp;</span> io<span class="token punctuation">.</span>carryIn<span class="token punctuation">.</span>getOrElse<span class="token punctuation">(</span><span class="token number">0.</span>U<span class="token punctuation">)</span>
  io<span class="token punctuation">.</span>s <span class="token operator">:</span><span class="token operator">=</span> sum<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  io<span class="token punctuation">.</span>carryOut <span class="token operator">:</span><span class="token operator">=</span> sum<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="example-optional-io-with-zero-width-wires"><a href="#example-optional-io-with-zero-width-wires" class="header-anchor">#</a> Example: Optional IO with Zero-Width Wires</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> HalfFullAdder<span class="token punctuation">(</span><span class="token keyword">val</span> hasCarry<span class="token operator">:</span> <span class="token builtin">Boolean</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Module <span class="token punctuation">{</span>
  <span class="token keyword">val</span> io <span class="token operator">=</span> IO<span class="token punctuation">(</span><span class="token keyword">new</span> Bundle <span class="token punctuation">{</span>
    <span class="token keyword">val</span> a <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> b <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> carryIn <span class="token operator">=</span> Input<span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span>hasCarry<span class="token punctuation">)</span> UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span> <span class="token keyword">else</span> UInt<span class="token punctuation">(</span><span class="token number">0.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> s <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> carryOut <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span><span class="token number">1.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> sum <span class="token operator">=</span> io<span class="token punctuation">.</span>a <span class="token operator">+</span><span class="token operator">&amp;</span> io<span class="token punctuation">.</span>b <span class="token operator">+</span><span class="token operator">&amp;</span> io<span class="token punctuation">.</span>carryIn
  io<span class="token punctuation">.</span>s <span class="token operator">:</span><span class="token operator">=</span> sum<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  io<span class="token punctuation">.</span>carryOut <span class="token operator">:</span><span class="token operator">=</span> sum<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>也可以用一个0宽度的wire来代替None。An IO with width zero is pruned from the emitted Verilog, and anything that tries to use the value of a zero-width wire gets a constant zero.</p> <h2 id="implicits"><a href="#implicits" class="header-anchor">#</a> Implicits</h2> <p>为了减少大量重复的模板代码，Scala引入了*隐式（implicits）*的概念，允许编译器为你自动进行一些语法简化。由于很多操作是在背后进行，隐式使用可能显得很神奇。</p> <h3 id="implicit-arguments"><a href="#implicit-arguments" class="header-anchor">#</a> Implicit Arguments</h3> <p>隐式参数的一个常见用途是当你的代码在深层的函数调用中需要访问某个顶层变量时，可以使用隐式参数自动传递这个变量，而不是手动在每个函数调用中传递它。</p> <h3 id="example-implicit-cats"><a href="#example-implicit-cats" class="header-anchor">#</a> Example: Implicit Cats</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">object</span> CatDog <span class="token punctuation">{</span>
  <span class="token keyword">implicit</span> <span class="token keyword">val</span> numberOfCats<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span> <span class="token number">3</span>
  <span class="token comment">//implicit val numberOfDogs: Int = 5</span>

  <span class="token keyword">def</span> tooManyCats<span class="token punctuation">(</span>nDogs<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">implicit</span> nCats<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Boolean</span> <span class="token operator">=</span> nCats <span class="token operator">&gt;</span> nDogs
    
  <span class="token keyword">val</span> imp <span class="token operator">=</span> tooManyCats<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment">// Argument passed implicitly!</span>
  <span class="token keyword">val</span> exp <span class="token operator">=</span> tooManyCats<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// Argument passed explicitly!</span>
<span class="token punctuation">}</span>
CatDog<span class="token punctuation">.</span>imp
CatDog<span class="token punctuation">.</span>exp
</code></pre></div><p>首先，我们定义了一个隐式值**<code>numberOfCats</code><strong>。在给定的作用域中，<strong>同一类型的隐式值只能有一个</strong>。然后，我们定义了一个函数，它接受两个参数列表；第一个是任何显式参数，第二个是任何隐式参数。当我们调用</strong><code>tooManyCats</code>**时，我们可以省略第二个隐式参数列表（让编译器为我们找到它），或者显式提供一个参数（这个参数可以与隐式值不同）。</p> <p>隐式参数可能<strong>失败</strong>的情况包括：</p> <ul><li>在一个作用域中定义了给定类型的两个或多个隐式值</li> <li>如果编译器找不到调用函数所需的隐式值</li></ul> <p>**<code>object</code><strong>定义了一个单例对象，它是一个类的单一实例。与</strong><code>class</code><strong>不同，当你定义一个</strong><code>object</code><strong>时，Scala会自动为你创建这个类的一个实例。你不需要使用</strong><code>new</code><strong>关键字来创建它的实例。在这个例子中，</strong><code>CatDog</code><strong>是一个单例对象，可以直接访问其成员，无需创建实例。这在定义工具方法或当你需要一个全局唯一的实体时非常有用，比如这里的</strong><code>numberOfCats</code><strong>隐式值和</strong><code>tooManyCats</code>**方法。</p> <h3 id="example-implicit-logging"><a href="#example-implicit-logging" class="header-anchor">#</a> Example: Implicit Logging</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">sealed</span> <span class="token keyword">trait</span> Verbosity
<span class="token keyword">implicit</span> <span class="token keyword">case</span> <span class="token keyword">object</span> Silent <span class="token keyword">extends</span> Verbosity
<span class="token keyword">case</span> <span class="token keyword">object</span> Verbose <span class="token keyword">extends</span> Verbosity

<span class="token keyword">class</span> ParameterizedWidthAdder<span class="token punctuation">(</span>in0Width<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> in1Width<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> sumWidth<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">implicit</span> verbosity<span class="token operator">:</span> Verbosity<span class="token punctuation">)</span>
<span class="token keyword">extends</span> Module <span class="token punctuation">{</span>
  <span class="token keyword">def</span> log<span class="token punctuation">(</span>msg<span class="token operator">:</span> <span class="token keyword">=&gt;</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> verbosity <span class="token keyword">match</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> Silent <span class="token keyword">=&gt;</span>
    <span class="token keyword">case</span> Verbose <span class="token keyword">=&gt;</span> println<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  require<span class="token punctuation">(</span>in0Width <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
  log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;in0Width of </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">in0Width</span></span><span class="token string"> OK&quot;</span></span><span class="token punctuation">)</span>
  require<span class="token punctuation">(</span>in1Width <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
  log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;in1Width of </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">in1Width</span></span><span class="token string"> OK&quot;</span></span><span class="token punctuation">)</span>
  require<span class="token punctuation">(</span>sumWidth <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
  log<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">&quot;sumWidth of </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">sumWidth</span></span><span class="token string"> OK&quot;</span></span><span class="token punctuation">)</span>
  <span class="token keyword">val</span> io <span class="token operator">=</span> IO<span class="token punctuation">(</span><span class="token keyword">new</span> Bundle <span class="token punctuation">{</span>
    <span class="token keyword">val</span> in0 <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span>in0Width<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> in1 <span class="token operator">=</span> Input<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span>in1Width<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> sum <span class="token operator">=</span> Output<span class="token punctuation">(</span>UInt<span class="token punctuation">(</span>sumWidth<span class="token punctuation">.</span>W<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  log<span class="token punctuation">(</span><span class="token string">&quot;Made IO&quot;</span><span class="token punctuation">)</span>
	<span class="token comment">// 对于结果位宽自然容纳进位的情况，直接使用+也是可行的。</span>
  io<span class="token punctuation">.</span>sum <span class="token operator">:</span><span class="token operator">=</span> io<span class="token punctuation">.</span>in0 <span class="token operator">+</span> io<span class="token punctuation">.</span>in1
  log<span class="token punctuation">(</span><span class="token string">&quot;Assigned output&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

println<span class="token punctuation">(</span>getVerilog<span class="token punctuation">(</span><span class="token keyword">new</span> ParameterizedWidthAdder<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
println<span class="token punctuation">(</span>getVerilog<span class="token punctuation">(</span><span class="token keyword">new</span> ParameterizedWidthAdder<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Verbose<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ol><li>定义了一个名为**<code>Verbosity</code><strong>的密封特质（</strong><code>sealed trait</code><strong>）和两个实现这个特质的对象。</strong><code>sealed trait Verbosity</code><strong>表示</strong><code>Verbosity</code><strong>是一个可以被继承的类型，但所有继承它的类必须定义在同一个文件中，这有助于实现模式匹配的完整性检查。</strong><code>implicit case object Silent extends Verbosity</code><strong>定义了一个隐式的单例对象</strong><code>Silent</code><strong>，它是</strong><code>Verbosity</code><strong>的一个实现，可以在需要</strong><code>Verbosity</code><strong>类型的隐式参数时自动使用。</strong><code>case object Verbose extends Verbosity</code><strong>定义了另一个名为</strong><code>Verbose</code><strong>的单例对象，也是</strong><code>Verbosity</code><strong>的实现。</strong><code>case object</code>**通常用于代表不可变、无状态的值或单例定义.</li> <li><strong><code>msg: =&gt; String</code><strong>这样的参数定义使用了名为“call-by-name”的参数传递机制。这种机制意味着，只有在函数内部实际使用到</strong><code>msg</code><strong>时，传入的字符串表达式才会被计算。这对于条件日志记录来说非常有用，因为它允许延迟计算日志消息直到确实需要打印消息时。例如，如果</strong><code>verbosity</code><strong>是</strong><code>Silent</code></strong>，则**<code>msg</code>**根本不会被计算，这样就避免了不必要的性能开销。</li></ol> <h3 id="implicit-conversions"><a href="#implicit-conversions" class="header-anchor">#</a> Implicit Conversions</h3> <p>隐式函数（也称为<strong>隐式转换</strong>）用于减少模板代码。更具体地说，它们用于自动将一个Scala对象转换为另一个对象。</p> <h3 id="example-implicit-conversion"><a href="#example-implicit-conversion" class="header-anchor">#</a> Example: Implicit Conversion</h3> <p>在下面的例子中，我们有两个类，<strong><code>Animal</code><strong>和</strong><code>Human</code></strong>。<strong><code>Animal</code><strong>有一个</strong><code>species</code><strong>字段，但</strong><code>Human</code><strong>没有。然而，通过实现一个隐式转换，我们可以在</strong><code>Human</code><strong>上调用</strong><code>species</code><strong>方法。这意味着即使</strong><code>Human</code><strong>类原本不包含</strong><code>species</code><strong>字段，通过隐式转换，我们也可以像访问自己的属性一样访问</strong><code>species</code></strong>，就好像这个属性是**<code>Human</code>**类的一部分一样。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> Animal<span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token keyword">val</span> species<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> Human<span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">)</span>
<span class="token keyword">implicit</span> <span class="token keyword">def</span> human2animal<span class="token punctuation">(</span>h<span class="token operator">:</span> Human<span class="token punctuation">)</span><span class="token operator">:</span> Animal <span class="token operator">=</span> <span class="token keyword">new</span> Animal<span class="token punctuation">(</span>h<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">&quot;Homo sapiens&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> me <span class="token operator">=</span> <span class="token keyword">new</span> Human<span class="token punctuation">(</span><span class="token string">&quot;Adam&quot;</span><span class="token punctuation">)</span>
println<span class="token punctuation">(</span>me<span class="token punctuation">.</span>species<span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Chip/Chip/2024.02.21-Chisel/2024.02.29-2.6 More on ChiselTest.html" class="prev">
        2024.02.29-2.6 More on ChiselTest
      </a></span> <span class="next"><a href="/Chip/Chip/2024.02.21-Chisel/2024.03.03-3.2 Generators Collections.html">
        2024.03.03-3.2 Generators: Collections
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.aca65f08.js" defer></script><script src="/assets/js/2.0c4bddf9.js" defer></script><script src="/assets/js/1.50b457b8.js" defer></script><script src="/assets/js/38.fb00ff7f.js" defer></script>
  </body>
</html>
